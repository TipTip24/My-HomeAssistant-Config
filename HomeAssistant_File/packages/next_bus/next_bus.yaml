#################################################################
#                                                               #
#                       Packages/Next Bus                       #
#                                                               #
#################################################################

#################################################################
#   Customize                                                   #
#################################################################

# homeassistant:
#   customize:
#     device_tracker.avi_avi:
#       friendly_name: Avi 
#       entity_picture: /local/known_devices/avi.png
      
    # sensor.next_bus:
    #   icon: 'mdi:bus-clock'


#################################################################
#   Next Bus                                                    #
################################################################# 

#################################################################
#   Sensors                                                     #
################################################################# 
# sensor:

  # - platform: template
  #   sensors:
  #     next_bus:
  #       friendly_name: Time to Next Bus
  #       unit_of_measurement: min
  #       value_template: >
  #         {% set min_now = states('sensor.time').split(':')[1]|int %}
  #         {% set time_now_h = states('sensor.time').split(":",)[0].replace("0", "")|int %}
  #         {% set time_now_m = states('sensor.time').split(":",)[1].replace("0", "")|int %}
  #         {% if now().strftime("%H")|int < 5 %}
  #           {{ (330 - (time_now_h*60) + (time_now_m)) }}
  #         {% elif now().strftime("%H")|int < 6 %}
  #           {{ 29 - min_now if min_now < 29 else 59 - min_now if min_now < 59 }}
  #         {% elif now().strftime("%H")|int < 7 %}
  #           {{ 19 - min_now if min_now < 19 else 39 - min_now if min_now < 39 else 59 - min_now if min_now < 59 }}
  #         {% elif now().strftime("%H")|int < 8 %}
  #           {{ 14 - min_now if min_now < 14 else 29 - min_now if min_now < 29 else 44 - min_now if min_now < 44 else 59 - min_now if min_now < 59 }}
  #         {% elif now().strftime("%H")|int < 9 %}
  #           {{ 14 - min_now if min_now < 9 else 29 - min_now if min_now < 29 else 49 - min_now if min_now < 49 }}
  #         {% elif now().strftime("%H")|int < 15 %}
  #           {{ 9 - min_now if min_now < 9 else 29 - min_now if min_now < 29 else 49 - min_now if min_now < 49 }}
  #         {% elif now().strftime("%H")|int < 18 %}
  #           {{ 14 - min_now if min_now < 14 else 24 - min_now if min_now < 24 else 39 - min_now if min_now < 39 else 54 - min_now if min_now < 54 }}
  #         {% elif now().strftime("%H")|int < 20 %}
  #           {{ 14 - min_now if min_now < 9 else 34 - min_now if min_now < 34 else 59 - min_now if min_now < 59 }}
  #         {% elif now().strftime("%H")|int < 24 %}
  #           {{ 29 - min_now if min_now < 29 else 59 - min_now if min_now < 59 }}
  #         {% else %}
  #           Unknown
  #         {% endif %}     